resource "azurerm_virtual_machine" "virtual_machine_good_1" {
  name                  = "acctvm"
  location              = "location"
  resource_group_name   = "group"
  network_interface_ids = ["id"]
  vm_size               = "Standard_F2"
  storage_os_disk {
    name          = "myosdisk1"
    caching       = "ReadWrite"
    create_option = "FromImage"
  }
  tags = {
    yor_trace = "28d6d910-c404-43b3-838d-d85572a29a12"
  }
}

resource "azurerm_virtual_machine" "virtual_machine_bad_1" {
  name                  = "acctvm"
  location              = "location"
  resource_group_name   = "group"
  network_interface_ids = ["id"]
  vm_size               = "Standard_F2"
  storage_os_disk {
    name          = "myosdisk1"
    caching       = "ReadWrite"
    create_option = "FromImage"
  }
  tags = {
    yor_trace = "cce7087b-035c-45bd-bbf9-eef860f07df0"
  }
}

resource "azurerm_virtual_machine" "virtual_machine_bad_2" {
  name                  = "acctvm"
  location              = "location"
  resource_group_name   = "group"
  network_interface_ids = ["id"]
  vm_size               = "Standard_F2"
  storage_os_disk {
    name          = "myosdisk1"
    caching       = "ReadWrite"
    create_option = "FromImage"
  }
  tags = {
    yor_trace = "00b0fadd-b5f0-4ea7-b5ba-01e0bc33bf52"
  }
}

resource "azurerm_virtual_machine" "virtual_machine_bad_3" {
  name                  = "acctvm"
  location              = "location"
  resource_group_name   = "group"
  network_interface_ids = ["id"]
  vm_size               = "Standard_F2"
  storage_os_disk {
    name          = "myosdisk1"
    caching       = "ReadWrite"
    create_option = "FromImage"
  }
  tags = {
    yor_trace = "9cdd2cdc-f50f-4a57-adf9-3d5afb5b9f3b"
  }
}

resource "azurerm_virtual_machine_extension" "extension_good_1" {
  name                       = "hostname"
  virtual_machine_id         = azurerm_virtual_machine.virtual_machine_good_1.id
  publisher                  = "Microsoft.Azure.Security"
  type                       = "IaaSAntimalware"
  type_handler_version       = "2.0"
  auto_upgrade_minor_version = true
  tags = {
    yor_trace = "c4fe4c74-e85f-4e0a-adc5-7c8b435fcefd"
  }
}

resource "azurerm_virtual_machine_extension" "extension_bad_1" {
  name                       = "hostname"
  virtual_machine_id         = azurerm_virtual_machine.virtual_machine_bad_1.id
  publisher                  = "Microsoft.Azure.Extensions"
  type                       = "IaaSAntimalware"
  type_handler_version       = "2.0"
  auto_upgrade_minor_version = true
  tags = {
    yor_trace = "dfd028e1-3143-4f94-adda-5983a7ad2298"
  }
}

resource "azurerm_virtual_machine_extension" "extension_bad_2" {
  name                       = "hostname"
  virtual_machine_id         = azurerm_virtual_machine.virtual_machine_bad_2.id
  publisher                  = "Microsoft.Azure.Security"
  type                       = "IaaSAntimalware"
  type_handler_version       = "2.0"
  auto_upgrade_minor_version = false
  tags = {
    yor_trace = "1d043550-ee4c-4e4b-bf81-f0af3b673aeb"
  }
}

resource "azurerm_virtual_machine_extension" "extension_bad_3" {
  name                       = "hostname"
  virtual_machine_id         = azurerm_virtual_machine.virtual_machine_bad_3.id
  publisher                  = "Microsoft.Azure.Security"
  type                       = "CustomScript"
  type_handler_version       = "2.0"
  auto_upgrade_minor_version = true
  tags = {
    yor_trace = "958ade7f-1081-42f3-b196-641ffc1bba0c"
  }
}